"use strict";function setGridHeight(t,e){var i=$("#gbox_"+t);i.height(e);var r=i.find(".ui-widget-header").height(),o=e-r;$("#"+t).jqGrid("setGridHeight",o),$("#"+t).jqGrid("setGridParam","height",o),$("#"+t).parents("div.ui-jqgrid-bdiv").css("max-height",e+"px")}function expandChildren(){$(".fa-plus-square-o").each(function(){$(this).trigger("click")})}function collapseChildren(){$(".fa-minus-square-o").each(function(){$(this).trigger("click")})}function showGridPager(t,e){var i=$("#"+t).jqGrid("getGridParam","pager");e?$(i).show():$(i).hide()}function getModelKey(t){var e=_($("#"+t).jqGrid("getGridParam","colModel")).filter(function(t){return t.isRowid}).value()[0];if(e)return e.name}function saveCSV(t,e,i){var r=$("#"+t).jqGrid("getGridParam","selarrrow");r.length||(r=$("#"+t).jqGrid("getDataIDs"));var o=_($("#"+t).jqGrid("getGridParam","colNames")).reject(function(t){return _.isEmpty(t)||"<"==t[0]}).value();o=_.difference(o,i);var a=void 0;a=navigator.appVersion.includes("Win")?"\r\n":"\n";var n=o.join(";")+a;o=_($("#"+t).jqGrid("getGridParam","colModel")).map("name").reject(function(t){return t.match(/^(cb|subgrid)$/)}).value();var d=!0,s=!1,l=void 0;try{for(var c,p=r[Symbol.iterator]();!(d=(c=p.next()).done);d=!0){var u=c.value;if(""!==u&&!u.match("^"+t+"ghead")){for(var f=$("#"+t).jqGrid("getRowData",u),m="",g=0;g<o.length;g++){var h=f[o[g]];o[g].match(/barcode|kodebrg/i)?h="'"+h:o[g].match(/margin/i)&&(h=h.replace(/\./,",")),h+=g<o.length-1?";":a,m+=h}n+=m}}}catch(t){s=!0,l=t}finally{try{!d&&p.return&&p.return()}finally{if(s)throw l}}if(e)n=n.replace(/;/g,"\t"),$("#dialog").length||($("body").append('<div id="dialog"><textarea id="copytext" style="width: 350px; height: 200px;"></textarea></div>'),$("#dialog").dialog({autoOpen:!1,buttons:{Ok:function(){$(this).dialog("close")}},width:380,title:$.i18n._("salin_text")})),$("#copytext").text(n),$("#dialog").dialog("open"),$("#copytext").select();else{var b=new Blob([n],{type:"text/csv;charset=utf-8"});saveAs(b,"records.csv")}}function processModel(t){for(var e=t.colDefinitions,i=[],r=0;r<e.length;r++)!function(r){var o={editrules:{},editoptions:{},search:!1,sortable:!_.has(t,"sortable")||t.sortable},a=e[r].split(/\|/),n=a[0].split(/=/),d=n[0],s=n[1];if(s){o.editable=!1,o.editrules.required=!0;for(var l=s.length;l--;){switch(s.charAt(l)){case"#":o.searchoptions={sopt:["cn"]},o.search=!0;break;case"a":o.editable=!0,o.editrules.disableOnEdit=!0;break;case"e":o.editable=!0,o.editrules.disableOnAdd=!0;break;case"g":o.editoptions.defaultValue="";case"r":o.editable=!0,o.editrules.readonly=!0;break;case"*":o.editable=!0;break;case"o":o.editrules.required=!1;break;case"i":o.isRowid=!0}}}switch(o.name=d,a[1]){case"hidden":o.hidden=!0,o.editrules.edithidden=!0,o.width=40;break;default:_.defaults(o,{width:parseInt(a[1]),sorttype:"currency",formatter:"currency",align:"right"}),o.editable&&(o.editoptions.width=o.width+"px")}switch(a[2]){case"currency":o.sorttype="currency",o.formatoptions={decimalPlaces:0,prefix:""},o.editrules.number=!0;break;case"numberc":o.align="center";case"number":o.sorttype="number",o.formatoptions={decimalPlaces:0,prefix:""},o.editrules.number=!0;break;case"number1c":o.align="center";case"number1":o.sorttype="number",o.formatoptions={decimalPlaces:1,prefix:""},o.editrules.number=!0;break;case"number2c":o.align="center";case"number2":o.sorttype="number",o.formatoptions={decimalPlaces:2,prefix:""},o.editrules.number=!0;break;case"percentagec":o.align="center";case"percentage":o.sorttype="number",o.formatoptions={decimalPlaces:2,prefix:"",suffix:"%"},o.formoptions={elmsuffix:"%"};break;case"percentage0":o.sorttype="number",o.formatoptions={decimalPlaces:0,prefix:"",suffix:"%"},o.formoptions={elmsuffix:"%"};break;case"percentage1":o.sorttype="number",o.formatoptions={decimalPlaces:1,prefix:"",suffix:"%"},o.formoptions={elmsuffix:"%"};break;case"textr":o.sorttype="text",o.formatter=void 0,parseInt(a[3])&&(o.editoptions={size:a[3]});break;case"textc":o.sorttype="text",o.formatter=void 0,o.align="center",parseInt(a[3])&&(o.editoptions={size:a[3]});break;case"date":o.sorttype="date",o.formatter="date",o.formatoptions={newformat:"Y-m-d"},o.align="center",o.editoptions={defaultValue:function(){return moment().format("YYYY-MM-DD")},size:10};break;case"time":o.sorttype="date",o.formatter="date",o.formatoptions={newformat:"g:i",parseRe:"[0-5][0-9]:[0-5][0-9]"},o.align="center",o.editoptions={defaultValue:function(){return moment().format("HH:mm")},size:5},o.fftype="time";break;case"check":o.sorttype="text",o.formatter="checkbox",o.align="center",o.edittype="checkbox",o.editoptions={value:"1:0"};break;case"action":o.template="actions",o.formatter=void 0,o.align="center";break;case"link":o.sorttype="text",o.prefix=a[3],o.formatter=function(t,e,i){return t?'<a href="'+t+'" target="_blank">'+(e.colModel.prefix||"Link")+"</a>":""},o.unformat=function(t,e,i){return $(i).find("a").attr("href")||""},o.align="center";break;case"image":o.sorttype="text",o.baseUrl=a[3],o.formatter=function(t,e,i){return t?'<a href="'+e.colModel.baseUrl+"/"+t+'" class="zoom-image"><img src="'+e.colModel.baseUrl+"/"+t+'" width="'+o.width+'"></a>':""},o.unformat=function(t,e,i){return $(i).find("img").attr("src").replace(/.*\//,"")||""},o.align="center",o.fftype="image";break;case"email":o.sorttype="text",o.formatter="email";break;default:o.sorttype="text",o.formatter=void 0,o.align="left"}if(a[3]){if(a[2].match(/text/)&&parseInt(a[3])){var c=a[3].split(/,/);c[1]?(o.edittype="textarea",o.editoptions={cols:c[0],rows:c[1]}):o.editoptions={size:c[0]}}"frozen"==a[3]?o.frozen=!0:["sum","avg","count","min","max"].includes(a[3])&&(o.summaryType=a[3])}a[4]&&(o.summaryTpl=a[4]),i.push(o)}(r);return i}function setupTree(t){_.defaults(t,{treeGrid:!0,treeGridModel:"adjacency",treedatatype:"json",datatype:"json",loadonce:!0,mtype:"POST",maxHeight:450,iconSet:"fontAwesome",treeIcons:{plus:"fa-caret-right",minus:"fa-caret-down",leaf:"fa-circle-o"},loadComplete:function(){t.expandOnLoad&&$(".tree-plus").each(function(){$(this).trigger("click")})}}),t.colNames=t.colNames.split(/\|/),t.colModel=processModel(t),$("#"+t.gridId).jqGrid(t)}function setupGrouping(t){var e=t.gridId,i=t.groupCol,r=void 0;r=i instanceof Array?i:[i],$("#"+e).jqGrid("setGridParam",{grouping:!0,groupingView:{groupField:r,groupColumnShow:$.map(r,function(t){return!1}),groupText:$.map(r,function(){if(!0===t.multiselect)return'{0}&nbsp;&nbsp;<input type="checkbox" class="grouping">'}),groupCollapse:!0,groupOrder:$.map(r,function(t){return"asc"}),groupSummary:$.map(r,function(t){return!0}),showSummaryOnHide:!0,groupDataSorted:!0},gridComplete:function(){$(".grouping").on("change",function(){var t=$(this).parent().parent();$(this).is(":checked")?t.find(".ui-icon-circlesmall-plus").click():t.find(".ui-icon-circlesmall-minus").click(),t.nextUntil(".jqfoot").each(function(){$("#"+e).jqGrid("setSelection",$(this).attr("id"))})})}})}function createFooterSummaryFunction(opt){var gridId=opt.gridId,cols=opt.footerSummary;if(!cols)return function(){return 0};for(var funcText="(function() { \n",i=0;i<cols.length;i++){var split=cols[i].split("|");split[1].match(/^(avg|sum)$/)&&(funcText+="  var "+split[1]+split[0]+" = $('#"+gridId+"').jqGrid('getCol', '"+split[0]+"', false, '"+split[1]+"');\n")}funcText+="  $('#"+gridId+"').jqGrid('footerData', 'set', {\n";for(var _i=0;_i<cols.length;_i++){var split=cols[_i].split("|");split[1].match(/^(avg|sum)$/)?funcText+="  "+split[0]+": "+split[1]+split[0]+",\n":funcText+="  "+split[0]+": "+split[1]+",\n"}return funcText+="  });\n",funcText+="})\n",eval(funcText)}function autoResize(t){$("#"+t).jqGrid("autoResizeAllColumns");var e=$("#"+t),i=e.jqGrid("getGridParam");_(i.colModel).filter(function(t){return t.autoResizable&&t.summaryType}).each(function(r){var o=(r.width,i.iColByName[r.name]),a=e.jqGrid("getAutoResizableWidth",o),n=$("#gview_"+t+" .footrow [aria-describedby="+t+"_"+r.name+"] span").outerWidth();n>a&&e.jqGrid("setColWidth",o,n+5)})}function setupGridI(opt){$("#"+opt.gridId).jqGrid("GridUnload");var options={autowidth:opt.autowidth,colNames:opt.colNames.split(/\|/),colModel:processModel(opt),cmTemplate:opt.autoresize?{autoResizable:!0}:{},datatype:"local",mtype:"POST",pager:"#"+opt.pagerId,rowNum:1e5,viewrecords:!0,gridview:!1,autoencode:!0,scrollerbar:!0,height:opt.height||opt.maxHeight||"auto",shrinkToFit:opt.shrinkToFit,loadonce:!0,caption:opt.caption,footerrow:!$.isEmptyObject(opt.footerSummary),multiselect:opt.multiselect,sortable:opt.sortable,iconSet:"fontAwesome",loadComplete:function(){createFooterSummaryFunction(opt)(),opt.expandOnLoad&&expandChildren(),opt.autoresize&&autoResize(opt.gridId);var t=parseInt($("#"+opt.gridId).jqGrid("getGridParam","width")),e="auto"==opt.width?opt.minWidth:opt.width||opt.minWidth;if(t<e&&$(this).jqGrid("setGridWidth",e),opt.width&&t>opt.width&&setTimeout(function(){$("#"+opt.gridId).jqGrid("setGridWidth",opt.width)},100),_.has(opt,"masterDetail.gridId")){var i=$("#gbox_"+opt.gridId),r=i.height(),o=i.find(".ui-widget-header").height();oriListH8=r-o,oriListdH8=$("#"+opt.masterDetail.gridId).jqGrid("getGridParam","height"),oriContainerH8=$(".module_content").height(),showGridPager(opt.masterDetail.gridId,!1)}_.isFunction(opt.afterLoadFunc)&&opt.afterLoadFunc(),t&&!opt.paging&&$("#gbox_"+opt.gridId+" .ui-jqgrid-bdiv").css("width",$("#gbox_"+opt.gridId).width()+18+"px"),_($("#"+opt.gridId).jqGrid("getGridParam","colModel")).map(function(t){return"image"==t.fftype}).filter(function(t){return t}).value().length&&$(".zoom-image").magnificPopup({type:"image",closeOnContentClick:!0,closeBtnInside:!1,fixedContentPos:!0,mainClass:"mfp-no-margins mfp-with-zoom",image:{verticalFit:!0},zoom:{enabled:!0,duration:300}}),$(".module_content").width()>960&&$("#gutter").css("position","absolute").css("left","960px").text("▼"),$("#errmsg").text("")},onHeaderClick:function(t){_.has(opt,"masterDetail.gridId")&&($(".module_content").height(oriContainerH8),"hidden"==t?setGridHeight(opt.masterDetail.gridId,oriListdH8+oriListH8):setGridHeight(opt.masterDetail.gridId,oriListdH8))},loadError:function(t,e,i){$("#errmsg").html("Type: "+e+"<br>Response: "+t.status+" "+t.statusText)}};if(opt.fieldProperties)for(var field in opt.fieldProperties)for(var i in options.colModel)if(options.colModel[i].name==field){$.extend(!0,options.colModel[i],opt.fieldProperties[field]);break}if(opt.cellEditing&&($.extend(options,{cellEdit:!0,afterSubmitCell:function(t,e){var i=$.parseJSON(t.responseText);return i.success?[!0,""]:[!1,i.message]}}),opt.cellEditing.editurl?(options.cellurl=opt.cellEditing.editurl,options.cellsubmit="remote"):$.extend(options,{cellsubmit:"clientArray",afterSaveCell:opt.cellEditing.afterSaveCell,datatype:"local"}),opt.cellEditing.fields&&$.each(opt.cellEditing.fields,function(t,e){for(var i in options.colModel){if(options.colModel[i].editrules.disableOnEdit)return void(options.colModel[i].editable=!1);if(options.colModel[i].name==e)return void(options.colModel[i].editable=!0)}})),opt.inlineEditing){var aftersavefunc=function(t,e){var i=$.parseJSON(e.responseText);return!!i.success||(alert($.i18n._("KESALAHAN",i.message)),!1)};$("#"+opt.gridId).jqGrid("navSeparatorAdd",pager,{sepclass:"ui-separator"}),$("#"+opt.gridId).jqGrid("inlineNav",pager,{editParams:{aftersavefunc:aftersavefunc,oneditfunc:function(){var t=$("#"+opt.gridId).jqGrid("getGridParam","colModel");$.each(t,function(t,e){e.name.match(/^(cb|subgrid)$/)||(e.editrules.disableOnEdit||e.editrules.readonly)&&$("[name='"+e.name+"'].editable").prop("disabled",!0).addClass("ui-state-disabled")})}},addParams:{addRowParams:{aftersavefunc:aftersavefunc,oneditfunc:function(){var t=$("#"+opt.gridId).jqGrid("getGridParam","colModel");$.each(t,function(t,e){e.name.match(/^(cb|subgrid)$/)||(e.editrules.disableOnAdd||e.editrules.readonly)&&$("[name='"+e.name+"'].editable").prop("disabled",!0).addClass("ui-state-disabled")})}}}})}if(opt.formEditing&&($.extend(options,{height:opt.maxHeight,autowidth:!1,rowNum:opt.paging?20:1e4,viewrecords:!0,datatype:"json",multiselect:opt.formEditing.multiselect||!1,gridview:!0}),opt.formEditing.url?$.extend(options,{url:opt.formEditing.url,editurl:opt.formEditing.editurl}):options.datatype="local",opt.formEditing.formOptions)){if(opt.formEditing.formOptions.fields)for(var _field in opt.formEditing.formOptions.fields)for(var _i3 in options.colModel)if(options.colModel[_i3].name==_field){$.extend(!0,options.colModel[_i3],opt.formEditing.formOptions.fields[_field]);break}if(opt.formEditing.formOptions.positions){for(var poss=opt.formEditing.formOptions.positions.split(/\|/),fullRowFields=[],_i4=0;_i4<poss.length;_i4++){var fopts=poss[_i4].split(/,/),value={formoptions:{rowpos:parseInt(fopts[1]),colpos:parseInt(fopts[2])||0}};for(var j in options.colModel)if(options.colModel[j].name==fopts[0]){$.extend(!0,options.colModel[j],value),fopts[2]||fullRowFields.push(fopts[0]);break}}fullRowFields.length&&(opt.formEditing.formOptions.fullRowFields=fullRowFields)}}if(opt.paging?$.extend(options,{scroll:1,loadonce:!1}):$.extend(options,{scroll:!1,loadonce:!0}),opt.otherOptions&&$.extend(options,opt.otherOptions),opt.masterDetail){var fclone=void 0;options.onSelectRow&&(fclone=options.onSelectRow.bind({})),options.onSelectRow=function(ids){var url=eval(opt.masterDetail.url);if($("#"+opt.masterDetail.gridId).jqGrid("setGridParam",{url:url,datatype:"json"}).trigger("reloadGrid"),opt.masterDetail.title){var data=$(this).jqGrid("getRowData",ids);$("#"+opt.masterDetail.gridId).jqGrid("setCaption",eval(opt.masterDetail.title))}setTimeout(function(){$("#"+opt.gridId).jqGrid("getGridParam","selrow")||$("#"+opt.gridId).jqGrid("setSelection",ids,!1)},100),showGridPager(opt.masterDetail.gridId,!0),fclone&&fclone(ids)}}options.shrinkToFit&&(options.width=opt.width||940),opt.colDefinitions.join("#").match(/kodebrg|barang|barcode/)&&(options.onRightClickRow=function(t,e,i,r){open_info(t)}),opt.hasSubgrid&&(options.subGrid=!0,options.subGridOptions={plusicon:"fa-caret-right",minusicon:"fa-caret-down",openicon:"fa-angle-double-up",reloadOnExpand:!1,selectOnExpand:!1});var grid=$("#"+opt.gridId);grid.jqGrid(options),opt.colDefinitions.join(":").match(/#/)&&grid.jqGrid("filterToolbar",{stringResult:!0,searchOnEnter:!0,defaultSearch:"cn"}),grid.parents("div.ui-jqgrid-bdiv").css("max-height",opt.maxHeight+"px"),grid.jqGrid("gridResize",{stop:function(t,e){var i=$("#gbox_"+opt.gridId),r=i.height(),o=i.find(".ui-widget-header").height(),a=r-o;grid.jqGrid("setGridParam","height",a),grid.parents("div.ui-jqgrid-bdiv").css("max-height",a+"px")}}),grid.on("press",function(t){grid.contextmenu(t)})}function PrintGrid(t){var e=t.gid;$("#prt-container").empty();var i=(print_header||'<img src="'+company_logo+'" style="height: 52px; float: left; padding: 0 10px;">\n      <h3>'+company_name+"<br>\n\t\t"+company_address+"\n      <br>Telp/Fax "+company_phone+"</h3>")+'<hr>\n\t<h2 style="text-align: center;">'+$("#"+e).jqGrid("getGridParam","caption")+"</h2>";_.defaults(t,{header:i}),$("#prt-container").append(t.header),$("#gview_"+e).clone().appendTo("#prt-container").css({"page-break-after":"auto"}),t.footer&&$("#prt-container").append(t.footer),$("#prt-container table.ui-jqgrid-htable, #prt-container table.ui-jqgrid-btable").css("width","958px"),$("tr.jqgfirstrow").css("width","958px"),$("#prt-container td[aria-describedby="+e+"_cb]").css("visibility","hidden"),$("#prt-container #"+e+"_cb").css("visibility","hidden"),$("#prt-container .grouping").css("visibility","hidden"),$("#prt-container .ui-jqgrid-ftable tr").removeClass("footrow footrow-ltr").appendTo($("#prt-container table:nth-child(2)"));var r=$("#"+e).jqGrid("getGridParam","selarrrow");if(r.length){ids=$("#"+e).jqGrid("getDataIDs");for(var o=0;o<ids.length;o++)$.inArray(ids[o],r)<0&&$("#prt-container #"+ids[o]).remove();$("#prt-container ."+e+"ghead_0 + .jqfoot").each(function(t){$(this).next().remove(),$(this).remove()}),$("#prt-container .jqfoot").remove(),$("#prt-container .jqgroup:last").remove()}if($("#prt-container div").remove(".ui-jqgrid-toppager,.ui-jqgrid-titlebar,.ui-jqgrid-pager"),t.excludeColumns){var a=$("#prt-container .jqgfirstrow td"),n=_($("#"+e).jqGrid("getGridParam").colModel).map("name").value(),d=!0,s=!1,l=void 0;try{for(var c,p=t.excludeColumns[Symbol.iterator]();!(d=(c=p.next()).done);d=!0)!function(){var t=c.value;$("#prt-container #"+e+"_"+t).hide(),$("#prt-container td[aria-describedby="+e+"_"+t+"]").hide();var i=_(n).findIndex(function(e){return e==t});$(a[i]).hide()}()}catch(t){s=!0,l=t}finally{try{!d&&p.return&&p.return()}finally{if(s)throw l}}}$("#prt-container td").css("padding","0 2px"),$('#prt-container tr[jqfootlevel="0"]').css("background","#ddd"),$('#prt-container tr[jqfootlevel="1"]').css("background","#eee"),$("#prt-container tr:last").css("border-top","solid 1px black").css("border-bottom","solid 1px black"),$("#prt-container [id^="+e+"ghead_0]").css("font-weight","bold"),$("#prt-container [id^="+e+"ghead_1]").css("font-style","italic"),$("#prt-container [id^="+e+"ghead_2]").css("text-decoration","underline"),$("#prt-container").print(),$("#prt-container").empty()}function setPrintGrid(t){var e=t.gridId,i=t.pagerId;$("#"+e).jqGrid("navSeparatorAdd","#"+i,{sepclass:"ui-separator"}),$("#"+e).jqGrid("navButtonAdd","#"+i,{id:"pager_print",title:$.i18n._("CETAK"),caption:$.i18n._("CETAK"),position:"last",buttonicon:"fa-print",iconsOverText:!0,onClickButton:function(){PrintGrid($.extend({gid:e},t.printOption))}})}function setupPager(t){var e="#"+t.pagerId,i={iconsOverText:!0,edit:!0,add:!0,del:!0,search:!1,refresh:!0,view:!1,excel:!1,pdf:!1,csv:!0,addtext:$.i18n._("BARU"),edittext:$.i18n._("EDIT"),deltext:$.i18n._("HAPUS"),searchtext:$.i18n._("CARI"),refreshtext:$.i18n._("REFRESH")},r={},o={},a={};if(t.inlineEditing){var n=function(t,e){var i=$.parseJSON(e.responseText);return!!i.success||(alert($.i18n._("KESALAHAN",i.message)),!1)};$("#"+t.gridId).jqGrid("navSeparatorAdd",e,{sepclass:"ui-separator"}),$("#"+t.gridId).jqGrid("inlineNav",e,{editParams:{aftersavefunc:n,oneditfunc:function(){var e=$("#"+t.gridId).jqGrid("getGridParam","colModel");$.each(e,function(t,e){e.name.match(/^(cb|subgrid)$/)||(e.editrules.disableOnEdit||e.editrules.readonly)&&$("[name='"+e.name+"'].editable").prop("disabled",!0).addClass("ui-state-disabled")})}},addParams:{addRowParams:{aftersavefunc:n,oneditfunc:function(){var e=$("#"+t.gridId).jqGrid("getGridParam","colModel");$.each(e,function(t,e){e.name.match(/^(cb|subgrid)$/)||(e.editrules.disableOnAdd||e.editrules.readonly)&&$("[name='"+e.name+"'].editable").prop("disabled",!0).addClass("ui-state-disabled")})}}}})}if(t.formEditing){var d=function(t,e,i){switch(i=i||0,e){case"currency":$(t).autoNumeric("init",{aSep:".",aDec:",",aSign:$.i18n._("CURR_PREF"),mDec:"0"}),$(t).autoNumeric("set",$(t).val()||0),$(t).css("text-align","right");break;case"number":$(t).autoNumeric("init",{aSep:".",aDec:",",mDec:i}),$(t).autoNumeric("set",$(t).val()||0),$(t).css("text-align","right");break;case"date":$(t).datepicker({dateFormat:"yy-mm-dd",showOn:"button"});break;case"time":$(t).timepicker({timeFormat:"H:i",showOn:["click"]})}},s=function(e,i){var r=$.parseJSON(e.responseText),o=void 0;if(r.success){if("add"==i.oper){var a=void 0,n=getModelKey(t.gridId);n&&(a=i[n]),o=[!0,"",a]}else o=[!0,""];return _.isFunction(t.formEditing.formOptions.afterSubmit)&&t.formEditing.formOptions.afterSubmit(e,i),o}return standard_dialog({title:$.i18n._("KESALAHAN0"),text:r.message}),[!1,r.message]},l=function(t){$(t).prop("disabled",!0).closest(".DataTD").prev(".CaptionTD").prop("disabled",!0).addClass("ui-state-disabled")};_.defaults(t.formEditing.formOptions,{width:400,closeAfterAdd:!1,closeAfterEdit:!0}),$.extend(i,{edit:!0,add:!0,del:!!t.formEditing.deleteMenu});var c=function(e){$(e).find("input[type='text']:visible:enabled:first").focus(),_.isFunction(t.formEditing.formOptions.afterShowForm)&&t.formEditing.formOptions.afterShowForm(),t.formEditing.formOptions.fullRowFields&&t.formEditing.formOptions.fullRowFields.forEach(function(t){var e=$("#tr_"+t+" td").length;$("#tr_"+t+" td:gt(1)").remove(),$("#tr_"+t+" td:last-child").attr("colspan",""+(e-1))}),t.formEditing.formOptions.height&&($("#editmodlist").css("max-height",t.formEditing.formOptions.height+"px").css("overflow-y","scroll"),$(".jqResize").hide())},p=function(){_.isFunction(t.formEditing.formOptions.onClose)&&t.formEditing.formOptions.onClose()};r={width:t.formEditing.formOptions.width,recreateForm:!0,afterSubmit:s,afterComplete:function(e,i,r){_.isFunction(t.formEditing.formOptions.afterCompleteFuncEdit)&&t.formEditing.formOptions.afterCompleteFuncEdit(e,i,r)},afterShowForm:c,reloadAfterSubmit:!1,closeAfterEdit:t.formEditing.formOptions.closeAfterEdit,beforeSubmit:t.formEditing.formOptions.beforeSubmit,onclickSubmit:t.formEditing.onclickSubmit,editData:t.formEditing.editData,onClose:p},o={width:t.formEditing.formOptions.width,recreateForm:!0,afterSubmit:s,afterComplete:function(e,i,r){if(_.isFunction(t.formEditing.formOptions.afterCompleteFuncAdd))t.formEditing.formOptions.afterCompleteFuncAdd(e,i,r);else{var o=i[getModelKey(t.gridId)];if("local"==$("#"+t.gridId).jqGrid("getGridParam","datatype")){var a={};_($("#"+t.gridId).jqGrid("getGridParam","colModel")).each(function(t){a[t.name]=i[t.name]}),$("#"+t.gridId).jqGrid("addRowData",o,a)}$("#"+t.gridId).jqGrid("setSelection",o)}},afterShowForm:c,onclickSubmit:t.formEditing.onclickSubmit,closeAfterAdd:t.formEditing.formOptions.closeAfterAdd,beforeSubmit:t.formEditing.formOptions.beforeSubmit,editData:t.formEditing.addData,onClose:p};var u=function(e,i,r){return _($(this).jqGrid("getGridParam","colModel")).filter(function(t){return t.editable&&t.sorttype.match(/currency|number/)}).map(function(t){return t.name}).each(function(t){e[t]=$(i).find("#"+t).autoNumeric("get")}),_.isFunction(t.formEditing.formOptions.beforeCheckValues)&&(e=t.formEditing.formOptions.beforeCheckValues(e)),e};r.beforeShowForm=function(e){var i=$("#"+t.gridId).jqGrid("getGridParam","colModel");$.each(i,function(t,i){if(!i.name.match(/^(cb|subgrid)$/)){var r=e.find("#"+i.name);(i.editrules.disableOnEdit||i.editrules.readonly)&&l(r),d(r,i.fftype||i.sorttype,_.get(i,"formatoptions.decimalPlaces",0))}})},r.beforeCheckValues=u,o.beforeShowForm=function(e){var i=$("#"+t.gridId).jqGrid("getGridParam","colModel");$.each(i,function(t,i){if(!i.name.match(/^(cb|subgrid)$/)){var r=e.find("#"+i.name);(i.editrules.disableOnAdd||i.editrules.readonly)&&l(r),d(r,i.sorttype,_.get(i,"formatoptions.decimalPlaces",0))}})},o.beforeCheckValues=u,a={afterSubmit:s,afterComplete:function(e,i,r){$("#"+t.gridId).jqGrid("getGridParam","colModel");if(_.has(t,"masterDetail.gridId")){showGridPager(t.masterDetail.gridId,!1),$("#"+t.masterDetail.gridId).jqGrid("clearGridData").jqGrid("setCaption","(Kosong)");var o=$("#"+t.masterDetail.gridId).jqGrid("footerData");if(o){for(var a in o)o[a]="";$("#"+t.masterDetail.gridId).jqGrid("footerData","set",o)}}_.isFunction(t.formEditing.formOptions.afterCompleteFuncDel)&&t.formEditing.formOptions.afterCompleteFuncDel(e,i,r)},onclickSubmit:t.formEditing.onclickSubmit,delData:t.formEditing.delData,onClose:p}}else $.extend(i,{edit:!1,add:!1,del:!1});$("#"+t.gridId).jqGrid("navGrid",e,i,r,o,a),t.formEditing||($("#"+t.gridId).jqGrid("navSeparatorAdd",e,{sepclass:"ui-separator"}),$.isEmptyObject(t.groupCol)||($("#"+t.gridId).jqGrid("navButtonAdd",e,{id:"pager_expand",title:$.i18n._("BUKA_SG"),caption:$.i18n._("BUKA"),buttonicon:"fa-folder-open-o",iconsOverText:!0,onClickButton:function(e){expandChildren(),$("#"+t.gridId).jqGrid("getGridParam","cmTemplate").autoResizable&&autoResize(t.gridId)}}),$("#"+t.gridId).jqGrid("navButtonAdd",e,{id:"pager_collapse",title:$.i18n._("TUTUP_SG"),caption:$.i18n._("TUTUP"),iconsOverText:!0,buttonicon:"fa-folder-o",onClickButton:function(t){collapseChildren()}})),$("#"+t.gridId).jqGrid("navButtonAdd",e,{id:"pager_csv",title:$.i18n._("SIMPAN_CSV"),caption:$.i18n._("SIMPAN"),iconsOverText:!0,buttonicon:"fa-save",onClickButton:function(e){saveCSV(t.gridId)}}),$("#"+t.gridId).jqGrid("navButtonAdd",e,{id:"pager_copy",caption:$.i18n._("SALIN"),iconsOverText:!0,title:$.i18n._("SALIN_CB"),buttonicon:"fa-clipboard",onClickButton:function(e){saveCSV(t.gridId,!0)}})),$(e+"_center").hide()}function setupGrid(t){_.defaults(t,{autoresize:!t.width&&!t.formEditing,multiselect:!0,shrinkToFit:!0,maxHeight:450,minWidth:700,paging:_.has(t,"formEditing"),sortable:!0,autowidth:!1}),t.autoresize&&(t.width="auto"),setupGridI(t),t.groupCol&&setupGrouping(t),t.pagerId&&$("#"+t.pagerId)&&setupPager(t),!t.paging&&$("#"+t.pagerId)&&setPrintGrid(t),$("#errmsg").length?$("#errmsg").text(""):$('<div id="errmsg" class="alert_error"></div>').insertAfter($("#pager"))}function setupSubgrid(opt){_.defaults(opt,{exclusiveShow:!0}),$("#"+opt.gridId).jqGrid("setGridParam",{subGridRowExpanded:function subGridRowExpanded(subgridId,rowid){var colNames=void 0,data=$("#"+opt.gridId).jqGrid("getRowData",rowid);colNames="function"==typeof opt.colNames?opt.colNames().split(/\|/):opt.colNames.split(/\|/);var subgridTableId=subgridId+"_t",eurl=_.isFunction(opt.url)?opt.url(rowid):eval(opt.url),optSub={gridId:subgridTableId,footerSummary:opt.footerSummary};opt.exclusiveShow&&$("#"+opt.gridId+" tr:has(.sgexpanded)").each(function(){var t=$(this).attr("id");t!=rowid&&$("#"+opt.gridId).jqGrid("collapseSubGridRow",t)});var options={cmTemplate:{autoResizable:!opt.width},autoresizeOnLoad:!opt.width,datatype:"json",loadonce:!0,mtype:"POST",url:eurl,colNames:colNames,colModel:processModel(opt),height:"100%",autowidth:!0,shrinkToFit:!1,rowNum:1e4,idPrefix:"s_"+rowid+"_",loadComplete:createFooterSummaryFunction(optSub),footerrow:!$.isEmptyObject(optSub.footerSummary)};if(opt.otherOptions&&$.extend(options,opt.otherOptions),_.map(options.colModel,"name").join("#").match(/kodebrg|barang|barcode/)&&(options.onRightClickRow=function(t,e,i,r){var o=$(this).jqGrid("getRowData",t),a=o.kodebrg||o.barcode||o.barang;open_info(a)}),$("#"+subgridId).html('<table id="'+subgridTableId+'"></table>'),$("#"+subgridTableId).jqGrid(options),options.pager){var _pager=$("#"+subgridTableId).jqGrid("getGridParam","pager"),pagerOptions={iconsOverText:!0,edit:!1,add:!1,del:!1,search:!1,refresh:!0,view:!1,excel:!1,pdf:!1,csv:!0,addtext:$.i18n._("BARU"),edittext:$.i18n._("EDIT"),deltext:$.i18n._("HAPUS"),searchtext:$.i18n._("CARI"),refreshtext:$.i18n._("REFRESH")};$("#"+subgridTableId).jqGrid("navGrid",_pager,pagerOptions),$(_pager+"_center").hide()}}})}function standard_dialog(t){$("#dialog").length||(_.defaults(t,{width:380,height:380,buttons:{Ok:function(){$(this).dialog("close")}}}),$("body").append('<div id="dialog">\n  <div id="dialog_content" style="width: '+t.width+"px; height: "+t.height+'px; "></div>\n  </div>'),$("#dialog").dialog({autoOpen:!1,buttons:t.buttons,width:t.width+30,height:t.height+110,title:t.title}),t.text&&(t.text=t.text.replace(/\n/g,"<br>")),$("#dialog_content").html(t.text),$("#dialog").on("dialogclose",function(t,e){$(this).remove()}),$("#dialog").dialog("open"))}function open_url_modal(t){if(!$("#"+t.window_id).length){_.defaults(t,{window_id:"modal_window",height:580,width:840});var e='<iframe id="'+t.window_id+'" style="overflow: hidden; border: 0px; width: '+t.width+"px; height: "+t.height+'px" src="'+t.url+'"></iframe>';$("<div></div>").html(e).dialog({autoOpen:!1,modal:!0,height:"auto",width:"auto",title:t.title,close:function(t,e){$(this).dialog("destroy")}}).dialog("open")}}function select_popup(t){$("#dialog_sp").length?$("#dialog_sp").empty():$("body").append('<div id="dialog_sp">\n    <select name="op" id="op">\n      <option selected>LIKE</option>\n      <option>FTS</option>\n      <option>&gt;</option>\n      <option>&lt;</option>\n      <option>=</option>\n    </select>\n    <input type="text" id="keyword">\n    <input type="button" value="Cari" id="search">\n    <br><br>\n    <table id="list_sp" width="100%"></table> \n    </div>'),$(document).on("click","#search",function(){var e=base_url+"/ajax/reference/table-search?keyword="+$("#keyword").val()+"&table="+t.table+"&fields="+t.fields.join(",")+"&searchFields="+t.searchFields.join(",")+"&op="+$("#op :selected").val();$("#list_sp").jqGrid("setGridParam",{datatype:"json",url:e}).trigger("reloadGrid")}).on("keydown","#keyword",function(t){13==t.which&&($("#search").click(),$(this).blur())}).on("click","#keyword",function(t){$("#keyword").val("")}),_.defaults(t,{width:500,height:400}),t.searchFields||(t.searchFields=t.fields),setupGrid($.extend(!0,t.gridOpt,{gridId:"list_sp",width:t.width-50+"px",maxHeight:t.height-175+"px",height:t.height-175+"px"})),$("#dialog_sp").dialog({buttons:{Pilih:function(){var e=void 0;e=t.gridOpt.multiselect?$("#list_sp").jqGrid("getGridParam","selarrrow"):$("#list_sp").jqGrid("getGridParam","selrow"),t.selected(e),$("#dialog_sp").dialog("close")}},width:t.width,height:t.height,title:"Cari"}),$("#keyword").focus()}function romanize(t){if(!+t)return!1;for(var e=String(+t).split(""),i=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],r="",o=3;o--;)r=(i[+e.pop()+10*o]||"")+r;return Array(+e.join("")+1).join("M")+r}function weekRangeString(t,e){var i=moment().year(e).isoWeek(t).isoWeekday(1),r=i.clone().add(1,"w");return i.format("YYYY-MM-DD")+" - "+r.format("YYYY-MM-DD")}function getWeek(t){return moment(t).week()}function getUrlParams(){for(var t=void 0,e=/\+/g,i=/([^&=]+)=?([^&]*)/g,r=function(t){return decodeURIComponent(t.replace(e," "))},o=window.location.search.substring(1),a={};t=i.exec(o);)a[r(t[1])]=r(t[2]);return a}function hasUrlParams(){return"?"==window.location.search[0]}function rp_format(t){var e=$.extend({},$.jgrid.formatter.currency,{decimalPlaces:0});return e.prefix+$.fmatter.NumberFormat(t,e)}function percent_format(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=$.extend({},$.jgrid.formatter.number,{decimalPlaces:e});return $.fmatter.NumberFormat(t,i)+"%"}function number_format(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=$.extend({},$.jgrid.formatter.number,{decimalPlaces:e});return $.fmatter.NumberFormat(t,i)}function arrayBulan(t){var e=["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],i=moment(),r=i.month();t.withCurrent&&r++;var o=i.year();if(r||o--,t.tahun==o&&r<12){var a=e.splice(0,r);e=e.concat(a)}return e}function namaBulan(t){}function selectOptions(t,e){return{edittype:"select",editoptions:{value:t,defaultValue:e},formatter:"select"}}function putFormSeparatorAfter(t,e){$('<tr class="FormData"><td class="CaptionTD ui-widget-content" colspan="2">\n<hr/><div style="padding:3px" class="ui-widget-header ui-corner-all">\n<b>'+e+"</b></div></td></tr>").insertAfter(t)}function selRowId(t){return $("#"+t).jqGrid("getGridParam","selrow")}function selRowData(t,e){var i=$("#"+t).jqGrid("getGridParam","selrow"),r=$("#"+t).jqGrid("getRowData",i);return e?r[e]:r}function alert_dialog(t){$("#alert").length||(_.defaults(t,{width:380,height:60,title:"Attention!",buttons:{Ok:function(){$(this).dialog("close")}}}),$("body").append('<div id="alert"><div id="alert_content" style="width: '+t.width+"px; height: "+t.height+'px; "></div></div>'),$("#alert").dialog({autoOpen:!1,buttons:t.buttons,width:t.width+30,height:t.height+110,title:t.title}),t.text&&(t.text=t.text.replace(/\n/g,"<br>")),$("#alert_content").html(t.text),$("#alert").on("dialogclose",function(t,e){$(this).remove()}),$("#alert").dialog("open"))}function confirmation_dialog(t){$("#confirmation").length||(_.defaults(t,{width:380,height:380,buttons:{Yes:function(){_.isFunction(t.onConfirm)&&t.onConfirm(),$(this).dialog("close")},No:function(){$(this).dialog("close")}}}),$("body").append('<div id="confirmation"><div id="confirmation_content" style="width: '+t.width+"px; height: "+t.height+'px; "></div></div>'),$("#confirmation").dialog({autoOpen:!1,
buttons:t.buttons,width:t.width+30,height:t.height+110,title:t.title}),t.text&&(t.text=t.text.replace(/\n/g,"<br>")),$("#confirmation_content").html(t.text),$("#confirmation").on("dialogclose",function(t,e){$(this).remove()}),$("#confirmation").dialog("open"))}function input2array(){var t={};return $("select").each(function(e,i){var r=$(i).prop("id");t[r]=$("#"+r).val()}),$("input").each(function(e,i){var r=$(i).prop("id"),o=$(i).prop("type"),a=$(i).val();if(!r.match(/cb_list|autogen|^$/))switch(o){case"text":case"select":case"hidden":var n=$("#"+r).select2("val");_.isArray(n)?t[r]=n:(a.match(/\|/)&&(a=a.replace(/ \|.*/,"")),t[r]=a);break;case"radio":$(i).prop("checked")&&(t[$(i).prop("name")]=a);break;case"checkbox":$(i).prop("checked")&&(t[r]=a)}}),resetCache&&(t.reset=1),t}function input2param(){var t=input2array(),e="";return $.each(t,function(t,i){e+="&"+t+"="+i}),e&&(e=e.substring(1)),e}function param2input(){if(!hasUrlParams())return"";var t=getUrlParams();return $.each(t,function(t,e){var i=$("#"+t);if(i){$(i).is("span")&&($("#"+t+" [value='"+e+"']").prop("checked",!0),$("#"+t).buttonset("refresh"));switch($(i).prop("type")){case"text":$("#"+t).val(e),e&&$("#"+t).removeAttr("placeholder");break;case"hidden":$("#"+t).val(e).change();break;case"checkbox":$("#"+t).prop("checked",!0)}}}),$.param(t)}function displayGrid(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";$("#"+t).jqGrid("setGridParam",{datatype:"json",url:e}).trigger("reloadGrid"),i&&$("#"+t).jqGrid("setCaption",i)}function HCLineOpt(t){var e={credits:{enabled:!1},chart:{type:"spline",renderTo:t.renderTo,plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1},title:{text:t.title},subtitle:{text:t.subtitle},xAxis:[{categories:t.categories,title:{text:t.xAxisTitle}}],yAxis:{labels:{formatter:chart_yaxis_legend_formatter},title:{text:t.yAxisTitle}},tooltip:{shared:!0,valueDecimals:2,pointFormatter:t.defaultPointFormat?function(){return'<span style="color:{this.color}">●</span> '+this.series.name+": <b>"+number_format(this.y,0)+"</b><br/>"}:function(){return'<span style="color:'+this.color+'">●</span> '+this.series.name+": <b>"+rp_unit_formatter(this.y)+"</b><br/>"}},legend:{labelFormatter:function(){return'<div class="'+this.name+'-arrow"></div>'+this.name+'<br/>\n                <span style="font-size:10px; color:#ababaa">'+rp_unit_formatter(this.options.total,2)+"</span>"+(t.legendAvg?'<br/><span style="font-size:10px; color:#ababaa">'+rp_unit_formatter(this.options.avg,2)+"</span>":"")}},series:[]},i=!0,r=!1,o=void 0;try{for(var a,n=t.seriesData.entries()[Symbol.iterator]();!(i=(a=n.next()).done);i=!0){var d=_slicedToArray(a.value,2),s=d[0],l=d[1],c=l.reduce(function(t,e){return t+e}),p=c/l.length;e.series.push({name:t.seriesName[s],data:l,total:c,avg:p})}}catch(t){r=!0,o=t}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}if(t.noLegendTotal&&delete e.legend.labelFormatter,t.defaultYAxisLegend&&delete e.yAxis.labels.formatter,t.avgRef){var u=t.avgRef.map(function(i){return{value:e.series[i].avg,label:{text:"Rata-rata "+t.seriesName[i]},dashStyle:"ShortDash",color:"grey",width:1,zIndex:5}});e.yAxis.plotLines=u}return e}function buildChartJSLine(t){var e={type:"line",data:{labels:t.categories,datasets:[]},options:{title:{display:!0,text:t.title},tooltips:{mode:"x",callbacks:{label:function(t,e){return e.datasets[t.datasetIndex].label+": "+rp_unit_formatter(t.yLabel)},labelColor:function(t,e){var i=t.datasetIndex,r=e.data.datasets[i].borderColor;return{borderColor:r,backgroundColor:r}}}},legend:{position:"bottom",labels:{generateLabels:function(t){return t.data.datasets.map(function(t,e){return{text:t.label+" "+rp_unit_formatter(t.total),fillStyle:t.borderColor,lineWidth:"0.25px",strokeStyle:"#fff",datasetIndex:e}},this)}}},scales:{yAxes:[{scaleLabel:{display:!0,labelString:t.yAxisTitle},ticks:{callback:function(t,e,i){return rp_unit_formatter(t)}}}]}}},i=!0,r=!1,o=void 0;try{for(var a,n=t.seriesData.entries()[Symbol.iterator]();!(i=(a=n.next()).done);i=!0){var d=_slicedToArray(a.value,2),s=d[0],l=d[1];e.data.datasets.push({label:t.seriesName[s],data:l,total:l.reduce(function(t,e){return t+e})})}}catch(t){r=!0,o=t}finally{try{!i&&n.return&&n.return()}finally{if(r)throw o}}return t.subtitle&&(e.options.title.text+=": "+t.subtitle),asignChartJSColor(e),e}function chart_yaxis_legend_formatter(){return 0==this.value?0:rp_unit_formatter(this.value,1)}function rp_unit_formatter(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,i=$.extend({},$.jgrid.formatter.number,{decimalPlaces:e});return Math.abs(t)>=1e8?$.fmatter.NumberFormat(t/1e9,i)+"M":Math.abs(t)>=1e5?$.fmatter.NumberFormat(t/1e6,i)+"J":Math.abs(t)>=1e3?$.fmatter.NumberFormat(t/1e3,i)+"R":$.fmatter.NumberFormat(t,i)}function resetCacheFunc(){resetCache=1,$("#load").click(),resetCache=0}var _slicedToArray=function(){function t(t,e){var i=[],r=!0,o=!1,a=void 0;try{for(var n,d=t[Symbol.iterator]();!(r=(n=d.next()).done)&&(i.push(n.value),!e||i.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{!r&&d.return&&d.return()}finally{if(o)throw a}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),oriListH8=void 0,oriListdH8=void 0,oriContainerH8=void 0,resetCache=0,ids="";$(function(){$(document).bind("contextmenu",function(){return!1}),$("input[type=submit], input[type=button]").button(),$("input:text, input:password, input[type=email]").button().addClass("ui-textfield").off("mousedown"),$("select").select2({minimumResultsForSearch:-1}),$("#main-menu").smartmenus({mainMenuSubOffsetX:-1,subMenusSubOffsetX:10,subMenusSubOffsetY:0}),$("#help-dialog").length?$("#help").button({icons:{primary:"ui-icon-help"},text:!1,label:"Help"}).click(function(){$("#help-dialog").dialog("open")}):$("#help").remove(),$("#help-dialog").dialog({autoOpen:!1,title:"Keterangan",minWidth:"450",modal:!0,buttons:{Ok:function(){$(this).dialog("close")}}}),$(".button-set").buttonset(),$(".date-picker").datepicker({dateFormat:"yy-mm-dd"}).datepicker("setDate",new Date).on("keydown",function(t){13==t.which&&($("#load").click(),$(this).blur())}),$("#reset-cache").button({icons:{primary:"ui-icon-refresh"},text:!1,label:"Refresh Data"}).click(function(){resetCacheFunc()}),$("#load").length||$("#reset-cache").hide()});